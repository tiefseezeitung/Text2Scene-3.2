2021-03-16 14:55:33,753 ----------------------------------------------------------------------------------------------------
2021-03-16 14:55:33,755 Model: "SequenceTagger(
  (embeddings): StackedEmbeddings(
    (list_embedding_0): WordEmbeddings('glove')
    (list_embedding_1): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
    (list_embedding_2): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
  )
  (word_dropout): WordDropout(p=0.05)
  (locked_dropout): LockedDropout(p=0.5)
  (embedding2nn): Linear(in_features=2148, out_features=2148, bias=True)
  (rnn): LSTM(2148, 128, batch_first=True, bidirectional=True)
  (linear): Linear(in_features=256, out_features=7, bias=True)
  (beta): 1.0
  (weights): None
  (weight_tensor) None
)"
2021-03-16 14:55:33,756 ----------------------------------------------------------------------------------------------------
2021-03-16 14:55:33,756 Corpus: "Corpus: 1000 train + 111 dev + 289 test sentences"
2021-03-16 14:55:33,757 ----------------------------------------------------------------------------------------------------
2021-03-16 14:55:33,758 Parameters:
2021-03-16 14:55:33,758  - learning_rate: "0.1"
2021-03-16 14:55:33,760  - mini_batch_size: "32"
2021-03-16 14:55:33,761  - patience: "3"
2021-03-16 14:55:33,762  - anneal_factor: "0.5"
2021-03-16 14:55:33,762  - max_epochs: "8"
2021-03-16 14:55:33,763  - shuffle: "True"
2021-03-16 14:55:33,763  - train_with_dev: "False"
2021-03-16 14:55:33,765  - batch_growth_annealing: "False"
2021-03-16 14:55:33,765 ----------------------------------------------------------------------------------------------------
2021-03-16 14:55:33,766 Model training base path: "resources_ilines/taggers/semantic_type"
2021-03-16 14:55:33,767 ----------------------------------------------------------------------------------------------------
2021-03-16 14:55:33,767 Device: cpu
2021-03-16 14:55:33,768 ----------------------------------------------------------------------------------------------------
2021-03-16 14:55:33,784 Embeddings storage mode: cpu
2021-03-16 14:55:33,785 ----------------------------------------------------------------------------------------------------
2021-03-16 14:55:50,308 epoch 1 - iter 3/32 - loss 15.41115665 - samples/sec: 5.81 - lr: 0.100000
2021-03-16 14:56:11,275 epoch 1 - iter 6/32 - loss 10.33075841 - samples/sec: 4.58 - lr: 0.100000
2021-03-16 14:56:27,420 epoch 1 - iter 9/32 - loss 8.34205680 - samples/sec: 5.95 - lr: 0.100000
2021-03-16 14:56:44,303 epoch 1 - iter 12/32 - loss 7.02267313 - samples/sec: 5.69 - lr: 0.100000
2021-03-16 14:57:04,206 epoch 1 - iter 15/32 - loss 6.48251685 - samples/sec: 4.82 - lr: 0.100000
2021-03-16 14:57:24,396 epoch 1 - iter 18/32 - loss 5.98401389 - samples/sec: 4.76 - lr: 0.100000
2021-03-16 14:57:43,642 epoch 1 - iter 21/32 - loss 5.57257213 - samples/sec: 4.99 - lr: 0.100000
2021-03-16 14:58:05,174 epoch 1 - iter 24/32 - loss 5.31851263 - samples/sec: 4.46 - lr: 0.100000
2021-03-16 14:58:22,457 epoch 1 - iter 27/32 - loss 5.05820379 - samples/sec: 5.55 - lr: 0.100000
2021-03-16 14:58:49,856 epoch 1 - iter 30/32 - loss 4.80520021 - samples/sec: 3.50 - lr: 0.100000
2021-03-16 14:58:59,985 ----------------------------------------------------------------------------------------------------
2021-03-16 14:58:59,986 EPOCH 1 done: loss 4.6241 - lr 0.1000000
2021-03-16 14:59:19,159 DEV : loss 1.9882779121398926 - score 0.9846
2021-03-16 14:59:19,187 BAD EPOCHS (no improvement): 0
2021-03-16 14:59:22,181 ----------------------------------------------------------------------------------------------------
2021-03-16 14:59:25,222 epoch 2 - iter 3/32 - loss 1.97470836 - samples/sec: 31.71 - lr: 0.100000
2021-03-16 14:59:28,149 epoch 2 - iter 6/32 - loss 2.00446409 - samples/sec: 32.81 - lr: 0.100000
2021-03-16 14:59:31,548 epoch 2 - iter 9/32 - loss 2.01281913 - samples/sec: 28.25 - lr: 0.100000
2021-03-16 14:59:34,901 epoch 2 - iter 12/32 - loss 2.05882543 - samples/sec: 28.65 - lr: 0.100000
2021-03-16 14:59:38,212 epoch 2 - iter 15/32 - loss 2.07116684 - samples/sec: 29.00 - lr: 0.100000
2021-03-16 14:59:41,466 epoch 2 - iter 18/32 - loss 2.05842568 - samples/sec: 29.52 - lr: 0.100000
2021-03-16 14:59:44,554 epoch 2 - iter 21/32 - loss 1.96742909 - samples/sec: 31.09 - lr: 0.100000
2021-03-16 14:59:48,740 epoch 2 - iter 24/32 - loss 1.91613554 - samples/sec: 22.94 - lr: 0.100000
2021-03-16 14:59:52,064 epoch 2 - iter 27/32 - loss 1.92500852 - samples/sec: 28.89 - lr: 0.100000
2021-03-16 14:59:55,965 epoch 2 - iter 30/32 - loss 1.88848589 - samples/sec: 24.62 - lr: 0.100000
2021-03-16 14:59:57,595 ----------------------------------------------------------------------------------------------------
2021-03-16 14:59:57,596 EPOCH 2 done: loss 1.8904 - lr 0.1000000
2021-03-16 14:59:59,244 DEV : loss 2.1991941928863525 - score 0.9823
2021-03-16 14:59:59,269 BAD EPOCHS (no improvement): 1
2021-03-16 14:59:59,273 ----------------------------------------------------------------------------------------------------
2021-03-16 15:00:04,450 epoch 3 - iter 3/32 - loss 1.40403986 - samples/sec: 18.55 - lr: 0.100000
2021-03-16 15:00:07,843 epoch 3 - iter 6/32 - loss 1.87204810 - samples/sec: 28.30 - lr: 0.100000
2021-03-16 15:00:11,131 epoch 3 - iter 9/32 - loss 1.74658182 - samples/sec: 29.20 - lr: 0.100000
2021-03-16 15:00:14,098 epoch 3 - iter 12/32 - loss 1.63090304 - samples/sec: 32.37 - lr: 0.100000
2021-03-16 15:00:17,198 epoch 3 - iter 15/32 - loss 1.66380263 - samples/sec: 30.98 - lr: 0.100000
2021-03-16 15:00:20,467 epoch 3 - iter 18/32 - loss 1.62759690 - samples/sec: 29.38 - lr: 0.100000
2021-03-16 15:00:23,556 epoch 3 - iter 21/32 - loss 1.62276468 - samples/sec: 31.09 - lr: 0.100000
2021-03-16 15:00:27,576 epoch 3 - iter 24/32 - loss 1.55434444 - samples/sec: 23.89 - lr: 0.100000
2021-03-16 15:00:31,715 epoch 3 - iter 27/32 - loss 1.55390910 - samples/sec: 23.20 - lr: 0.100000
2021-03-16 15:00:34,656 epoch 3 - iter 30/32 - loss 1.56617255 - samples/sec: 32.66 - lr: 0.100000
2021-03-16 15:00:36,339 ----------------------------------------------------------------------------------------------------
2021-03-16 15:00:36,340 EPOCH 3 done: loss 1.5505 - lr 0.1000000
2021-03-16 15:00:37,679 DEV : loss 1.3194758892059326 - score 0.9896
2021-03-16 15:00:37,703 BAD EPOCHS (no improvement): 0
2021-03-16 15:00:40,882 ----------------------------------------------------------------------------------------------------
2021-03-16 15:00:44,431 epoch 4 - iter 3/32 - loss 1.41876050 - samples/sec: 27.15 - lr: 0.100000
2021-03-16 15:00:48,707 epoch 4 - iter 6/32 - loss 1.27258480 - samples/sec: 22.46 - lr: 0.100000
2021-03-16 15:00:51,755 epoch 4 - iter 9/32 - loss 1.25841897 - samples/sec: 31.51 - lr: 0.100000
2021-03-16 15:00:55,059 epoch 4 - iter 12/32 - loss 1.25182177 - samples/sec: 29.06 - lr: 0.100000
2021-03-16 15:00:58,336 epoch 4 - iter 15/32 - loss 1.30703888 - samples/sec: 29.30 - lr: 0.100000
2021-03-16 15:01:02,245 epoch 4 - iter 18/32 - loss 1.27532843 - samples/sec: 24.57 - lr: 0.100000
2021-03-16 15:01:05,469 epoch 4 - iter 21/32 - loss 1.23766463 - samples/sec: 29.79 - lr: 0.100000
2021-03-16 15:01:09,051 epoch 4 - iter 24/32 - loss 1.25409410 - samples/sec: 26.81 - lr: 0.100000
2021-03-16 15:01:12,099 epoch 4 - iter 27/32 - loss 1.22772972 - samples/sec: 31.51 - lr: 0.100000
2021-03-16 15:01:15,654 epoch 4 - iter 30/32 - loss 1.21112402 - samples/sec: 27.01 - lr: 0.100000
2021-03-16 15:01:17,525 ----------------------------------------------------------------------------------------------------
2021-03-16 15:01:17,526 EPOCH 4 done: loss 1.2046 - lr 0.1000000
2021-03-16 15:01:18,885 DEV : loss 0.9636843204498291 - score 0.9924
2021-03-16 15:01:18,910 BAD EPOCHS (no improvement): 0
2021-03-16 15:01:22,041 ----------------------------------------------------------------------------------------------------
2021-03-16 15:01:25,480 epoch 5 - iter 3/32 - loss 0.94940205 - samples/sec: 28.29 - lr: 0.100000
2021-03-16 15:01:29,641 epoch 5 - iter 6/32 - loss 1.19783684 - samples/sec: 23.08 - lr: 0.100000
2021-03-16 15:01:32,618 epoch 5 - iter 9/32 - loss 1.18512324 - samples/sec: 32.26 - lr: 0.100000
2021-03-16 15:01:35,903 epoch 5 - iter 12/32 - loss 1.19827717 - samples/sec: 29.23 - lr: 0.100000
2021-03-16 15:01:39,420 epoch 5 - iter 15/32 - loss 1.24475497 - samples/sec: 27.30 - lr: 0.100000
2021-03-16 15:01:43,478 epoch 5 - iter 18/32 - loss 1.23864065 - samples/sec: 23.66 - lr: 0.100000
2021-03-16 15:01:47,117 epoch 5 - iter 21/32 - loss 1.24404929 - samples/sec: 26.39 - lr: 0.100000
2021-03-16 15:01:50,487 epoch 5 - iter 24/32 - loss 1.20820992 - samples/sec: 28.49 - lr: 0.100000
2021-03-16 15:01:54,654 epoch 5 - iter 27/32 - loss 1.20554032 - samples/sec: 23.05 - lr: 0.100000
2021-03-16 15:01:58,166 epoch 5 - iter 30/32 - loss 1.18814087 - samples/sec: 27.34 - lr: 0.100000
2021-03-16 15:01:59,139 ----------------------------------------------------------------------------------------------------
2021-03-16 15:01:59,140 EPOCH 5 done: loss 1.1309 - lr 0.1000000
2021-03-16 15:02:00,498 DEV : loss 0.8612627387046814 - score 0.9933
2021-03-16 15:02:00,522 BAD EPOCHS (no improvement): 0
2021-03-16 15:02:03,657 ----------------------------------------------------------------------------------------------------
2021-03-16 15:02:06,427 epoch 6 - iter 3/32 - loss 0.96605104 - samples/sec: 35.39 - lr: 0.100000
2021-03-16 15:02:10,743 epoch 6 - iter 6/32 - loss 0.85899519 - samples/sec: 22.25 - lr: 0.100000
2021-03-16 15:02:14,204 epoch 6 - iter 9/32 - loss 0.87293430 - samples/sec: 27.75 - lr: 0.100000
2021-03-16 15:02:18,208 epoch 6 - iter 12/32 - loss 0.84054106 - samples/sec: 23.98 - lr: 0.100000
2021-03-16 15:02:21,358 epoch 6 - iter 15/32 - loss 0.90729021 - samples/sec: 30.49 - lr: 0.100000
2021-03-16 15:02:24,958 epoch 6 - iter 18/32 - loss 0.86207758 - samples/sec: 26.68 - lr: 0.100000
2021-03-16 15:02:28,706 epoch 6 - iter 21/32 - loss 0.84869908 - samples/sec: 25.62 - lr: 0.100000
2021-03-16 15:02:32,287 epoch 6 - iter 24/32 - loss 0.87961056 - samples/sec: 26.82 - lr: 0.100000
2021-03-16 15:02:36,050 epoch 6 - iter 27/32 - loss 0.84475786 - samples/sec: 25.51 - lr: 0.100000
2021-03-16 15:02:39,608 epoch 6 - iter 30/32 - loss 0.85555651 - samples/sec: 26.99 - lr: 0.100000
2021-03-16 15:02:41,032 ----------------------------------------------------------------------------------------------------
2021-03-16 15:02:41,033 EPOCH 6 done: loss 0.9207 - lr 0.1000000
2021-03-16 15:02:42,374 DEV : loss 0.9389979839324951 - score 0.9935
2021-03-16 15:02:42,398 BAD EPOCHS (no improvement): 0
2021-03-16 15:02:45,516 ----------------------------------------------------------------------------------------------------
2021-03-16 15:02:49,350 epoch 7 - iter 3/32 - loss 0.82894981 - samples/sec: 25.32 - lr: 0.100000
2021-03-16 15:02:52,291 epoch 7 - iter 6/32 - loss 0.72943697 - samples/sec: 32.66 - lr: 0.100000
2021-03-16 15:02:56,135 epoch 7 - iter 9/32 - loss 0.86614141 - samples/sec: 24.98 - lr: 0.100000
2021-03-16 15:02:59,866 epoch 7 - iter 12/32 - loss 0.93397795 - samples/sec: 25.74 - lr: 0.100000
2021-03-16 15:03:03,331 epoch 7 - iter 15/32 - loss 0.87586927 - samples/sec: 27.71 - lr: 0.100000
2021-03-16 15:03:06,783 epoch 7 - iter 18/32 - loss 0.83601684 - samples/sec: 27.82 - lr: 0.100000
2021-03-16 15:03:09,817 epoch 7 - iter 21/32 - loss 0.79269907 - samples/sec: 31.65 - lr: 0.100000
2021-03-16 15:03:12,719 epoch 7 - iter 24/32 - loss 0.78914612 - samples/sec: 33.09 - lr: 0.100000
2021-03-16 15:03:16,192 epoch 7 - iter 27/32 - loss 0.77602456 - samples/sec: 27.65 - lr: 0.100000
2021-03-16 15:03:20,341 epoch 7 - iter 30/32 - loss 0.77270002 - samples/sec: 23.15 - lr: 0.100000
2021-03-16 15:03:22,527 ----------------------------------------------------------------------------------------------------
2021-03-16 15:03:22,527 EPOCH 7 done: loss 0.7622 - lr 0.1000000
2021-03-16 15:03:23,863 DEV : loss 0.6455795764923096 - score 0.9944
2021-03-16 15:03:23,889 BAD EPOCHS (no improvement): 0
2021-03-16 15:03:27,074 ----------------------------------------------------------------------------------------------------
2021-03-16 15:03:31,213 epoch 8 - iter 3/32 - loss 0.76078673 - samples/sec: 23.29 - lr: 0.100000
2021-03-16 15:03:34,698 epoch 8 - iter 6/32 - loss 0.66481783 - samples/sec: 27.56 - lr: 0.100000
2021-03-16 15:03:37,739 epoch 8 - iter 9/32 - loss 0.62571263 - samples/sec: 31.58 - lr: 0.100000
2021-03-16 15:03:41,702 epoch 8 - iter 12/32 - loss 0.68016898 - samples/sec: 24.23 - lr: 0.100000
2021-03-16 15:03:45,675 epoch 8 - iter 15/32 - loss 0.72401185 - samples/sec: 24.17 - lr: 0.100000
2021-03-16 15:03:48,706 epoch 8 - iter 18/32 - loss 0.79438378 - samples/sec: 31.69 - lr: 0.100000
2021-03-16 15:03:52,205 epoch 8 - iter 21/32 - loss 0.78065472 - samples/sec: 27.44 - lr: 0.100000
2021-03-16 15:03:55,382 epoch 8 - iter 24/32 - loss 0.81362115 - samples/sec: 30.23 - lr: 0.100000
2021-03-16 15:03:58,556 epoch 8 - iter 27/32 - loss 0.79080914 - samples/sec: 30.25 - lr: 0.100000
2021-03-16 15:04:01,701 epoch 8 - iter 30/32 - loss 0.77475000 - samples/sec: 30.53 - lr: 0.100000
2021-03-16 15:04:03,754 ----------------------------------------------------------------------------------------------------
2021-03-16 15:04:03,755 EPOCH 8 done: loss 0.7596 - lr 0.1000000
2021-03-16 15:04:05,190 DEV : loss 0.7118802070617676 - score 0.9944
2021-03-16 15:04:05,217 BAD EPOCHS (no improvement): 1
2021-03-16 15:04:08,319 ----------------------------------------------------------------------------------------------------
2021-03-16 15:04:08,334 Testing using best model ...
2021-03-16 15:04:08,357 loading file resources_ilines/taggers/semantic_type/best-model.pt
2021-03-16 15:05:14,536 	0.9962
2021-03-16 15:05:14,537 
Results:
- F-score (micro): 0.9962
- F-score (macro): 0.6988
- Accuracy (incl. no class): 0.9962

By class:
              precision    recall  f1-score   support

           O     0.9995    0.9997    0.9996     11593
 TOPOLOGICAL     0.8803    0.9058    0.8929       138
     DIR_TOP     0.5556    0.3571    0.4348        28
 DIRECTIONAL     0.4400    0.5000    0.4681        22

    accuracy                         0.9962     11781
   macro avg     0.7188    0.6907    0.6988     11781
weighted avg     0.9960    0.9962    0.9960     11781

2021-03-16 15:05:14,538 ----------------------------------------------------------------------------------------------------
