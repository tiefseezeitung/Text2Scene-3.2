2021-03-16 14:35:46,248 ----------------------------------------------------------------------------------------------------
2021-03-16 14:35:46,249 Model: "SequenceTagger(
  (embeddings): StackedEmbeddings(
    (list_embedding_0): WordEmbeddings('glove')
    (list_embedding_1): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
    (list_embedding_2): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
  )
  (word_dropout): WordDropout(p=0.05)
  (locked_dropout): LockedDropout(p=0.5)
  (embedding2nn): Linear(in_features=2148, out_features=2148, bias=True)
  (rnn): LSTM(2148, 128, batch_first=True, bidirectional=True)
  (linear): Linear(in_features=256, out_features=14, bias=True)
  (beta): 1.0
  (weights): None
  (weight_tensor) None
)"
2021-03-16 14:35:46,250 ----------------------------------------------------------------------------------------------------
2021-03-16 14:35:46,250 Corpus: "Corpus: 1000 train + 111 dev + 289 test sentences"
2021-03-16 14:35:46,251 ----------------------------------------------------------------------------------------------------
2021-03-16 14:35:46,252 Parameters:
2021-03-16 14:35:46,253  - learning_rate: "0.1"
2021-03-16 14:35:46,253  - mini_batch_size: "32"
2021-03-16 14:35:46,254  - patience: "3"
2021-03-16 14:35:46,255  - anneal_factor: "0.5"
2021-03-16 14:35:46,256  - max_epochs: "8"
2021-03-16 14:35:46,257  - shuffle: "True"
2021-03-16 14:35:46,257  - train_with_dev: "False"
2021-03-16 14:35:46,258  - batch_growth_annealing: "False"
2021-03-16 14:35:46,258 ----------------------------------------------------------------------------------------------------
2021-03-16 14:35:46,259 Model training base path: "resources_ilines/taggers/motion_class"
2021-03-16 14:35:46,260 ----------------------------------------------------------------------------------------------------
2021-03-16 14:35:46,261 Device: cpu
2021-03-16 14:35:46,275 ----------------------------------------------------------------------------------------------------
2021-03-16 14:35:46,275 Embeddings storage mode: cpu
2021-03-16 14:35:46,277 ----------------------------------------------------------------------------------------------------
2021-03-16 14:36:05,310 epoch 1 - iter 3/32 - loss 48.29091867 - samples/sec: 5.04 - lr: 0.100000
2021-03-16 14:36:27,027 epoch 1 - iter 6/32 - loss 26.48651711 - samples/sec: 4.42 - lr: 0.100000
2021-03-16 14:36:44,130 epoch 1 - iter 9/32 - loss 19.01490951 - samples/sec: 5.61 - lr: 0.100000
2021-03-16 14:37:07,795 epoch 1 - iter 12/32 - loss 15.73794442 - samples/sec: 4.06 - lr: 0.100000
2021-03-16 14:37:24,603 epoch 1 - iter 15/32 - loss 13.41223264 - samples/sec: 5.71 - lr: 0.100000
2021-03-16 14:37:46,529 epoch 1 - iter 18/32 - loss 11.81884933 - samples/sec: 4.38 - lr: 0.100000
2021-03-16 14:38:06,930 epoch 1 - iter 21/32 - loss 10.68021728 - samples/sec: 4.71 - lr: 0.100000
2021-03-16 14:38:24,921 epoch 1 - iter 24/32 - loss 9.71834889 - samples/sec: 5.34 - lr: 0.100000
2021-03-16 14:38:42,282 epoch 1 - iter 27/32 - loss 9.01054850 - samples/sec: 5.53 - lr: 0.100000
2021-03-16 14:39:07,876 epoch 1 - iter 30/32 - loss 8.43746144 - samples/sec: 3.75 - lr: 0.100000
2021-03-16 14:39:16,360 ----------------------------------------------------------------------------------------------------
2021-03-16 14:39:16,361 EPOCH 1 done: loss 8.0584 - lr 0.1000000
2021-03-16 14:39:37,870 DEV : loss 2.0724267959594727 - score 0.9844
2021-03-16 14:39:37,892 BAD EPOCHS (no improvement): 0
2021-03-16 14:39:41,201 ----------------------------------------------------------------------------------------------------
2021-03-16 14:39:45,440 epoch 2 - iter 3/32 - loss 2.55986464 - samples/sec: 24.33 - lr: 0.100000
2021-03-16 14:39:50,134 epoch 2 - iter 6/32 - loss 2.99341236 - samples/sec: 20.45 - lr: 0.100000
2021-03-16 14:39:53,835 epoch 2 - iter 9/32 - loss 2.85869600 - samples/sec: 25.95 - lr: 0.100000
2021-03-16 14:39:58,092 epoch 2 - iter 12/32 - loss 2.64691979 - samples/sec: 22.55 - lr: 0.100000
2021-03-16 14:40:02,092 epoch 2 - iter 15/32 - loss 2.48899862 - samples/sec: 24.01 - lr: 0.100000
2021-03-16 14:40:05,747 epoch 2 - iter 18/32 - loss 2.40823357 - samples/sec: 26.27 - lr: 0.100000
2021-03-16 14:40:08,546 epoch 2 - iter 21/32 - loss 2.30246224 - samples/sec: 34.31 - lr: 0.100000
2021-03-16 14:40:12,287 epoch 2 - iter 24/32 - loss 2.24968514 - samples/sec: 25.67 - lr: 0.100000
2021-03-16 14:40:15,788 epoch 2 - iter 27/32 - loss 2.22671945 - samples/sec: 27.43 - lr: 0.100000
2021-03-16 14:40:19,297 epoch 2 - iter 30/32 - loss 2.16509169 - samples/sec: 27.36 - lr: 0.100000
2021-03-16 14:40:20,541 ----------------------------------------------------------------------------------------------------
2021-03-16 14:40:20,542 EPOCH 2 done: loss 2.1030 - lr 0.1000000
2021-03-16 14:40:21,829 DEV : loss 1.3927738666534424 - score 0.9881
2021-03-16 14:40:21,850 BAD EPOCHS (no improvement): 0
2021-03-16 14:40:26,059 ----------------------------------------------------------------------------------------------------
2021-03-16 14:40:29,976 epoch 3 - iter 3/32 - loss 1.82117057 - samples/sec: 24.61 - lr: 0.100000
2021-03-16 14:40:33,433 epoch 3 - iter 6/32 - loss 1.78940384 - samples/sec: 27.77 - lr: 0.100000
2021-03-16 14:40:36,671 epoch 3 - iter 9/32 - loss 1.71392157 - samples/sec: 29.66 - lr: 0.100000
2021-03-16 14:40:39,943 epoch 3 - iter 12/32 - loss 1.70986710 - samples/sec: 29.35 - lr: 0.100000
2021-03-16 14:40:44,540 epoch 3 - iter 15/32 - loss 1.71856144 - samples/sec: 20.89 - lr: 0.100000
2021-03-16 14:40:47,813 epoch 3 - iter 18/32 - loss 1.74563785 - samples/sec: 29.33 - lr: 0.100000
2021-03-16 14:40:52,529 epoch 3 - iter 21/32 - loss 1.70589184 - samples/sec: 20.36 - lr: 0.100000
2021-03-16 14:40:55,852 epoch 3 - iter 24/32 - loss 1.70055906 - samples/sec: 28.90 - lr: 0.100000
2021-03-16 14:40:59,347 epoch 3 - iter 27/32 - loss 1.65725682 - samples/sec: 27.48 - lr: 0.100000
2021-03-16 14:41:02,904 epoch 3 - iter 30/32 - loss 1.64543821 - samples/sec: 27.00 - lr: 0.100000
2021-03-16 14:41:04,170 ----------------------------------------------------------------------------------------------------
2021-03-16 14:41:04,171 EPOCH 3 done: loss 1.6184 - lr 0.1000000
2021-03-16 14:41:05,537 DEV : loss 1.2720451354980469 - score 0.9895
2021-03-16 14:41:05,560 BAD EPOCHS (no improvement): 0
2021-03-16 14:41:08,761 ----------------------------------------------------------------------------------------------------
2021-03-16 14:41:11,877 epoch 4 - iter 3/32 - loss 1.51125391 - samples/sec: 31.31 - lr: 0.100000
2021-03-16 14:41:15,430 epoch 4 - iter 6/32 - loss 1.50954739 - samples/sec: 27.03 - lr: 0.100000
2021-03-16 14:41:19,133 epoch 4 - iter 9/32 - loss 1.53321801 - samples/sec: 25.94 - lr: 0.100000
2021-03-16 14:41:23,181 epoch 4 - iter 12/32 - loss 1.55864847 - samples/sec: 23.72 - lr: 0.100000
2021-03-16 14:41:26,917 epoch 4 - iter 15/32 - loss 1.58906582 - samples/sec: 25.71 - lr: 0.100000
2021-03-16 14:41:30,099 epoch 4 - iter 18/32 - loss 1.54134788 - samples/sec: 30.17 - lr: 0.100000
2021-03-16 14:41:34,298 epoch 4 - iter 21/32 - loss 1.57683258 - samples/sec: 22.87 - lr: 0.100000
2021-03-16 14:41:37,499 epoch 4 - iter 24/32 - loss 1.55313231 - samples/sec: 30.00 - lr: 0.100000
2021-03-16 14:41:41,385 epoch 4 - iter 27/32 - loss 1.53790094 - samples/sec: 24.71 - lr: 0.100000
2021-03-16 14:41:44,435 epoch 4 - iter 30/32 - loss 1.49987878 - samples/sec: 31.49 - lr: 0.100000
2021-03-16 14:41:46,608 ----------------------------------------------------------------------------------------------------
2021-03-16 14:41:46,608 EPOCH 4 done: loss 1.5014 - lr 0.1000000
2021-03-16 14:41:47,880 DEV : loss 1.2424097061157227 - score 0.9893
2021-03-16 14:41:47,902 BAD EPOCHS (no improvement): 1
2021-03-16 14:41:47,906 ----------------------------------------------------------------------------------------------------
2021-03-16 14:41:51,199 epoch 5 - iter 3/32 - loss 1.54760726 - samples/sec: 29.16 - lr: 0.100000
2021-03-16 14:41:54,389 epoch 5 - iter 6/32 - loss 1.30249921 - samples/sec: 30.10 - lr: 0.100000
2021-03-16 14:41:58,622 epoch 5 - iter 9/32 - loss 1.47344981 - samples/sec: 22.68 - lr: 0.100000
2021-03-16 14:42:01,458 epoch 5 - iter 12/32 - loss 1.37326745 - samples/sec: 33.86 - lr: 0.100000
2021-03-16 14:42:06,726 epoch 5 - iter 15/32 - loss 1.39948244 - samples/sec: 18.23 - lr: 0.100000
2021-03-16 14:42:10,451 epoch 5 - iter 18/32 - loss 1.38230232 - samples/sec: 25.78 - lr: 0.100000
2021-03-16 14:42:14,068 epoch 5 - iter 21/32 - loss 1.36263255 - samples/sec: 26.55 - lr: 0.100000
2021-03-16 14:42:17,557 epoch 5 - iter 24/32 - loss 1.39179165 - samples/sec: 27.52 - lr: 0.100000
2021-03-16 14:42:21,621 epoch 5 - iter 27/32 - loss 1.38104847 - samples/sec: 23.63 - lr: 0.100000
2021-03-16 14:42:24,579 epoch 5 - iter 30/32 - loss 1.39786173 - samples/sec: 32.47 - lr: 0.100000
2021-03-16 14:42:25,839 ----------------------------------------------------------------------------------------------------
2021-03-16 14:42:25,842 EPOCH 5 done: loss 1.4098 - lr 0.1000000
2021-03-16 14:42:27,119 DEV : loss 1.2121671438217163 - score 0.9893
2021-03-16 14:42:27,141 BAD EPOCHS (no improvement): 2
2021-03-16 14:42:27,142 ----------------------------------------------------------------------------------------------------
2021-03-16 14:42:30,560 epoch 6 - iter 3/32 - loss 1.51270541 - samples/sec: 28.10 - lr: 0.100000
2021-03-16 14:42:34,875 epoch 6 - iter 6/32 - loss 1.46527461 - samples/sec: 22.25 - lr: 0.100000
2021-03-16 14:42:37,914 epoch 6 - iter 9/32 - loss 1.35126286 - samples/sec: 31.60 - lr: 0.100000
2021-03-16 14:42:42,057 epoch 6 - iter 12/32 - loss 1.33863075 - samples/sec: 23.17 - lr: 0.100000
2021-03-16 14:42:45,676 epoch 6 - iter 15/32 - loss 1.39267299 - samples/sec: 26.53 - lr: 0.100000
2021-03-16 14:42:49,109 epoch 6 - iter 18/32 - loss 1.36949790 - samples/sec: 27.97 - lr: 0.100000
2021-03-16 14:42:53,233 epoch 6 - iter 21/32 - loss 1.35693400 - samples/sec: 23.29 - lr: 0.100000
2021-03-16 14:42:56,839 epoch 6 - iter 24/32 - loss 1.35838917 - samples/sec: 26.63 - lr: 0.100000
2021-03-16 14:43:00,623 epoch 6 - iter 27/32 - loss 1.34691538 - samples/sec: 25.37 - lr: 0.100000
2021-03-16 14:43:04,157 epoch 6 - iter 30/32 - loss 1.33089874 - samples/sec: 27.17 - lr: 0.100000
2021-03-16 14:43:05,695 ----------------------------------------------------------------------------------------------------
2021-03-16 14:43:05,695 EPOCH 6 done: loss 1.3680 - lr 0.1000000
2021-03-16 14:43:06,974 DEV : loss 1.1605377197265625 - score 0.9898
2021-03-16 14:43:06,996 BAD EPOCHS (no improvement): 0
2021-03-16 14:43:10,203 ----------------------------------------------------------------------------------------------------
2021-03-16 14:43:14,174 epoch 7 - iter 3/32 - loss 1.39091269 - samples/sec: 24.39 - lr: 0.100000
2021-03-16 14:43:17,920 epoch 7 - iter 6/32 - loss 1.29939365 - samples/sec: 25.64 - lr: 0.100000
2021-03-16 14:43:21,455 epoch 7 - iter 9/32 - loss 1.19200887 - samples/sec: 27.17 - lr: 0.100000
2021-03-16 14:43:25,492 epoch 7 - iter 12/32 - loss 1.29163225 - samples/sec: 23.79 - lr: 0.100000
2021-03-16 14:43:29,288 epoch 7 - iter 15/32 - loss 1.27470185 - samples/sec: 25.30 - lr: 0.100000
2021-03-16 14:43:33,138 epoch 7 - iter 18/32 - loss 1.26524266 - samples/sec: 24.94 - lr: 0.100000
2021-03-16 14:43:36,621 epoch 7 - iter 21/32 - loss 1.30477607 - samples/sec: 27.57 - lr: 0.100000
2021-03-16 14:43:41,090 epoch 7 - iter 24/32 - loss 1.33389927 - samples/sec: 21.49 - lr: 0.100000
2021-03-16 14:43:44,400 epoch 7 - iter 27/32 - loss 1.34867051 - samples/sec: 29.01 - lr: 0.100000
2021-03-16 14:43:47,319 epoch 7 - iter 30/32 - loss 1.33281033 - samples/sec: 32.91 - lr: 0.100000
2021-03-16 14:43:48,568 ----------------------------------------------------------------------------------------------------
2021-03-16 14:43:48,569 EPOCH 7 done: loss 1.3423 - lr 0.1000000
2021-03-16 14:43:49,876 DEV : loss 1.0801985263824463 - score 0.9895
2021-03-16 14:43:49,898 BAD EPOCHS (no improvement): 1
2021-03-16 14:43:49,900 ----------------------------------------------------------------------------------------------------
2021-03-16 14:43:52,872 epoch 8 - iter 3/32 - loss 1.41194884 - samples/sec: 32.32 - lr: 0.100000
2021-03-16 14:43:57,014 epoch 8 - iter 6/32 - loss 1.24855876 - samples/sec: 23.18 - lr: 0.100000
2021-03-16 14:44:01,622 epoch 8 - iter 9/32 - loss 1.23148721 - samples/sec: 20.84 - lr: 0.100000
2021-03-16 14:44:04,827 epoch 8 - iter 12/32 - loss 1.25572313 - samples/sec: 29.97 - lr: 0.100000
2021-03-16 14:44:08,322 epoch 8 - iter 15/32 - loss 1.23961153 - samples/sec: 27.47 - lr: 0.100000
2021-03-16 14:44:12,079 epoch 8 - iter 18/32 - loss 1.24645086 - samples/sec: 25.56 - lr: 0.100000
2021-03-16 14:44:15,187 epoch 8 - iter 21/32 - loss 1.23229891 - samples/sec: 30.90 - lr: 0.100000
2021-03-16 14:44:18,649 epoch 8 - iter 24/32 - loss 1.27540669 - samples/sec: 27.74 - lr: 0.100000
2021-03-16 14:44:21,447 epoch 8 - iter 27/32 - loss 1.26225479 - samples/sec: 34.32 - lr: 0.100000
2021-03-16 14:44:24,809 epoch 8 - iter 30/32 - loss 1.25774020 - samples/sec: 28.56 - lr: 0.100000
2021-03-16 14:44:26,641 ----------------------------------------------------------------------------------------------------
2021-03-16 14:44:26,642 EPOCH 8 done: loss 1.2822 - lr 0.1000000
2021-03-16 14:44:27,927 DEV : loss 1.2916135787963867 - score 0.9888
2021-03-16 14:44:27,948 BAD EPOCHS (no improvement): 2
2021-03-16 14:44:30,950 ----------------------------------------------------------------------------------------------------
2021-03-16 14:44:30,998 Testing using best model ...
2021-03-16 14:44:31,002 loading file resources_ilines/taggers/motion_class/best-model.pt
2021-03-16 14:45:35,167 	0.9902
2021-03-16 14:45:35,168 
Results:
- F-score (micro): 0.9902
- F-score (macro): 0.2238
- Accuracy (incl. no class): 0.9902

By class:
               precision    recall  f1-score   support

            O     0.9999    0.9999    0.9999     11579
        CROSS     0.3684    0.4375    0.4000        16
        REACH     0.5100    0.6986    0.5896        73
MOVE_INTERNAL     0.0000    0.0000    0.0000        11
MOVE_EXTERNAL     1.0000    0.0000    0.0000         7
       FOLLOW     1.0000    0.0000    0.0000        16
         MOVE     0.3659    0.6667    0.4724        45
          HIT     1.0000    0.0000    0.0000        13
        LEAVE     1.0000    0.0000    0.0000        14
      DEVIATE     1.0000    0.0000    0.0000         4
       DETACH     1.0000    0.0000    0.0000         3

     accuracy                         0.9902     11781
    macro avg     0.7495    0.2548    0.2238     11781
 weighted avg     0.9927    0.9902    0.9888     11781

2021-03-16 14:45:35,169 ----------------------------------------------------------------------------------------------------
