2021-03-16 13:13:40,597 ----------------------------------------------------------------------------------------------------
2021-03-16 13:13:40,597 Model: "SequenceTagger(
  (embeddings): StackedEmbeddings(
    (list_embedding_0): WordEmbeddings('glove')
    (list_embedding_1): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
    (list_embedding_2): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
  )
  (word_dropout): WordDropout(p=0.05)
  (locked_dropout): LockedDropout(p=0.5)
  (embedding2nn): Linear(in_features=2148, out_features=2148, bias=True)
  (rnn): LSTM(2148, 128, batch_first=True, bidirectional=True)
  (linear): Linear(in_features=256, out_features=14, bias=True)
  (beta): 1.0
  (weights): None
  (weight_tensor) None
)"
2021-03-16 13:13:40,598 ----------------------------------------------------------------------------------------------------
2021-03-16 13:13:40,599 Corpus: "Corpus: 1000 train + 111 dev + 289 test sentences"
2021-03-16 13:13:40,599 ----------------------------------------------------------------------------------------------------
2021-03-16 13:13:40,600 Parameters:
2021-03-16 13:13:40,601  - learning_rate: "0.1"
2021-03-16 13:13:40,602  - mini_batch_size: "32"
2021-03-16 13:13:40,603  - patience: "3"
2021-03-16 13:13:40,604  - anneal_factor: "0.5"
2021-03-16 13:13:40,605  - max_epochs: "8"
2021-03-16 13:13:40,605  - shuffle: "True"
2021-03-16 13:13:40,607  - train_with_dev: "False"
2021-03-16 13:13:40,607  - batch_growth_annealing: "False"
2021-03-16 13:13:40,608 ----------------------------------------------------------------------------------------------------
2021-03-16 13:13:40,609 Model training base path: "resources/taggers/motion_class"
2021-03-16 13:13:40,609 ----------------------------------------------------------------------------------------------------
2021-03-16 13:13:40,610 Device: cpu
2021-03-16 13:13:40,611 ----------------------------------------------------------------------------------------------------
2021-03-16 13:13:40,612 Embeddings storage mode: cpu
2021-03-16 13:13:40,623 ----------------------------------------------------------------------------------------------------
2021-03-16 13:13:53,648 epoch 1 - iter 3/32 - loss 44.87768237 - samples/sec: 7.37 - lr: 0.100000
2021-03-16 13:14:02,357 epoch 1 - iter 6/32 - loss 24.57649382 - samples/sec: 11.02 - lr: 0.100000
2021-03-16 13:14:13,962 epoch 1 - iter 9/32 - loss 18.44556888 - samples/sec: 8.27 - lr: 0.100000
2021-03-16 13:14:24,313 epoch 1 - iter 12/32 - loss 15.06835548 - samples/sec: 9.28 - lr: 0.100000
2021-03-16 13:14:34,038 epoch 1 - iter 15/32 - loss 12.79081219 - samples/sec: 9.87 - lr: 0.100000
2021-03-16 13:14:46,203 epoch 1 - iter 18/32 - loss 11.54695674 - samples/sec: 7.89 - lr: 0.100000
2021-03-16 13:14:57,768 epoch 1 - iter 21/32 - loss 10.37591183 - samples/sec: 8.30 - lr: 0.100000
2021-03-16 13:15:13,436 epoch 1 - iter 24/32 - loss 9.60204717 - samples/sec: 6.13 - lr: 0.100000
2021-03-16 13:15:24,439 epoch 1 - iter 27/32 - loss 8.87620065 - samples/sec: 8.73 - lr: 0.100000
2021-03-16 13:15:37,991 epoch 1 - iter 30/32 - loss 8.25739050 - samples/sec: 7.08 - lr: 0.100000
2021-03-16 13:15:42,737 ----------------------------------------------------------------------------------------------------
2021-03-16 13:15:42,737 EPOCH 1 done: loss 7.8831 - lr 0.1000000
2021-03-16 13:15:54,006 DEV : loss 4.235887050628662 - score 0.969
2021-03-16 13:15:54,022 BAD EPOCHS (no improvement): 0
2021-03-16 13:15:56,639 ----------------------------------------------------------------------------------------------------
2021-03-16 13:15:58,420 epoch 2 - iter 3/32 - loss 3.93660283 - samples/sec: 53.94 - lr: 0.100000
2021-03-16 13:16:00,744 epoch 2 - iter 6/32 - loss 3.65824064 - samples/sec: 41.33 - lr: 0.100000
2021-03-16 13:16:02,802 epoch 2 - iter 9/32 - loss 3.54134761 - samples/sec: 46.67 - lr: 0.100000
2021-03-16 13:16:04,582 epoch 2 - iter 12/32 - loss 3.33422887 - samples/sec: 53.97 - lr: 0.100000
2021-03-16 13:16:06,175 epoch 2 - iter 15/32 - loss 3.16635356 - samples/sec: 60.32 - lr: 0.100000
2021-03-16 13:16:09,172 epoch 2 - iter 18/32 - loss 3.12962091 - samples/sec: 32.04 - lr: 0.100000
2021-03-16 13:16:11,225 epoch 2 - iter 21/32 - loss 3.18020612 - samples/sec: 46.78 - lr: 0.100000
2021-03-16 13:16:13,404 epoch 2 - iter 24/32 - loss 3.15448812 - samples/sec: 44.08 - lr: 0.100000
2021-03-16 13:16:15,263 epoch 2 - iter 27/32 - loss 3.16050895 - samples/sec: 51.67 - lr: 0.100000
2021-03-16 13:16:16,864 epoch 2 - iter 30/32 - loss 3.07259863 - samples/sec: 60.00 - lr: 0.100000
2021-03-16 13:16:17,956 ----------------------------------------------------------------------------------------------------
2021-03-16 13:16:17,957 EPOCH 2 done: loss 2.9920 - lr 0.1000000
2021-03-16 13:16:18,746 DEV : loss 3.2751941680908203 - score 0.969
2021-03-16 13:16:18,762 BAD EPOCHS (no improvement): 0
2021-03-16 13:16:21,904 ----------------------------------------------------------------------------------------------------
2021-03-16 13:16:24,156 epoch 3 - iter 3/32 - loss 2.77262779 - samples/sec: 42.70 - lr: 0.100000
2021-03-16 13:16:26,084 epoch 3 - iter 6/32 - loss 2.62207713 - samples/sec: 49.80 - lr: 0.100000
2021-03-16 13:16:27,666 epoch 3 - iter 9/32 - loss 2.71345055 - samples/sec: 60.72 - lr: 0.100000
2021-03-16 13:16:29,563 epoch 3 - iter 12/32 - loss 2.79427041 - samples/sec: 50.65 - lr: 0.100000
2021-03-16 13:16:31,582 epoch 3 - iter 15/32 - loss 2.65770498 - samples/sec: 47.55 - lr: 0.100000
2021-03-16 13:16:34,361 epoch 3 - iter 18/32 - loss 2.61902505 - samples/sec: 34.57 - lr: 0.100000
2021-03-16 13:16:35,943 epoch 3 - iter 21/32 - loss 2.56975135 - samples/sec: 60.70 - lr: 0.100000
2021-03-16 13:16:37,882 epoch 3 - iter 24/32 - loss 2.60584616 - samples/sec: 49.54 - lr: 0.100000
2021-03-16 13:16:39,692 epoch 3 - iter 27/32 - loss 2.59930668 - samples/sec: 53.05 - lr: 0.100000
2021-03-16 13:16:41,348 epoch 3 - iter 30/32 - loss 2.60366497 - samples/sec: 58.01 - lr: 0.100000
2021-03-16 13:16:42,193 ----------------------------------------------------------------------------------------------------
2021-03-16 13:16:42,194 EPOCH 3 done: loss 2.6457 - lr 0.1000000
2021-03-16 13:16:42,988 DEV : loss 2.8055927753448486 - score 0.9731
2021-03-16 13:16:43,004 BAD EPOCHS (no improvement): 0
2021-03-16 13:16:46,072 ----------------------------------------------------------------------------------------------------
2021-03-16 13:16:47,891 epoch 4 - iter 3/32 - loss 2.51859935 - samples/sec: 52.85 - lr: 0.100000
2021-03-16 13:16:49,597 epoch 4 - iter 6/32 - loss 2.80420323 - samples/sec: 56.33 - lr: 0.100000
2021-03-16 13:16:51,157 epoch 4 - iter 9/32 - loss 2.65110411 - samples/sec: 61.57 - lr: 0.100000
2021-03-16 13:16:53,944 epoch 4 - iter 12/32 - loss 2.59926789 - samples/sec: 34.46 - lr: 0.100000
2021-03-16 13:16:55,639 epoch 4 - iter 15/32 - loss 2.57579562 - samples/sec: 56.68 - lr: 0.100000
2021-03-16 13:16:57,523 epoch 4 - iter 18/32 - loss 2.63408836 - samples/sec: 50.98 - lr: 0.100000
2021-03-16 13:16:59,550 epoch 4 - iter 21/32 - loss 2.66864852 - samples/sec: 47.38 - lr: 0.100000
2021-03-16 13:17:01,225 epoch 4 - iter 24/32 - loss 2.59549283 - samples/sec: 57.35 - lr: 0.100000
2021-03-16 13:17:03,328 epoch 4 - iter 27/32 - loss 2.58653695 - samples/sec: 45.68 - lr: 0.100000
2021-03-16 13:17:05,866 epoch 4 - iter 30/32 - loss 2.54722820 - samples/sec: 37.83 - lr: 0.100000
2021-03-16 13:17:06,627 ----------------------------------------------------------------------------------------------------
2021-03-16 13:17:06,628 EPOCH 4 done: loss 2.5292 - lr 0.1000000
2021-03-16 13:17:07,407 DEV : loss 2.6980137825012207 - score 0.972
2021-03-16 13:17:07,422 BAD EPOCHS (no improvement): 1
2021-03-16 13:17:07,423 ----------------------------------------------------------------------------------------------------
2021-03-16 13:17:09,011 epoch 5 - iter 3/32 - loss 2.45653264 - samples/sec: 60.51 - lr: 0.100000
2021-03-16 13:17:10,718 epoch 5 - iter 6/32 - loss 2.61011052 - samples/sec: 56.28 - lr: 0.100000
2021-03-16 13:17:13,247 epoch 5 - iter 9/32 - loss 2.47147854 - samples/sec: 37.97 - lr: 0.100000
2021-03-16 13:17:15,501 epoch 5 - iter 12/32 - loss 2.50036416 - samples/sec: 42.63 - lr: 0.100000
2021-03-16 13:17:17,262 epoch 5 - iter 15/32 - loss 2.64197709 - samples/sec: 54.53 - lr: 0.100000
2021-03-16 13:17:19,193 epoch 5 - iter 18/32 - loss 2.60096406 - samples/sec: 49.76 - lr: 0.100000
2021-03-16 13:17:21,220 epoch 5 - iter 21/32 - loss 2.63664984 - samples/sec: 47.37 - lr: 0.100000
2021-03-16 13:17:23,000 epoch 5 - iter 24/32 - loss 2.59022215 - samples/sec: 53.96 - lr: 0.100000
2021-03-16 13:17:24,630 epoch 5 - iter 27/32 - loss 2.49189787 - samples/sec: 58.94 - lr: 0.100000
2021-03-16 13:17:26,542 epoch 5 - iter 30/32 - loss 2.52276327 - samples/sec: 50.25 - lr: 0.100000
2021-03-16 13:17:27,456 ----------------------------------------------------------------------------------------------------
2021-03-16 13:17:27,456 EPOCH 5 done: loss 2.4914 - lr 0.1000000
2021-03-16 13:17:28,244 DEV : loss 2.7691168785095215 - score 0.9717
2021-03-16 13:17:28,260 BAD EPOCHS (no improvement): 2
2021-03-16 13:17:28,261 ----------------------------------------------------------------------------------------------------
2021-03-16 13:17:31,055 epoch 6 - iter 3/32 - loss 2.79119031 - samples/sec: 34.38 - lr: 0.100000
2021-03-16 13:17:32,878 epoch 6 - iter 6/32 - loss 2.38264851 - samples/sec: 52.67 - lr: 0.100000
2021-03-16 13:17:34,837 epoch 6 - iter 9/32 - loss 2.37430628 - samples/sec: 49.06 - lr: 0.100000
2021-03-16 13:17:36,506 epoch 6 - iter 12/32 - loss 2.39394957 - samples/sec: 57.55 - lr: 0.100000
2021-03-16 13:17:38,425 epoch 6 - iter 15/32 - loss 2.30534126 - samples/sec: 50.04 - lr: 0.100000
2021-03-16 13:17:40,690 epoch 6 - iter 18/32 - loss 2.30567880 - samples/sec: 42.40 - lr: 0.100000
2021-03-16 13:17:42,467 epoch 6 - iter 21/32 - loss 2.30417753 - samples/sec: 54.06 - lr: 0.100000
2021-03-16 13:17:44,272 epoch 6 - iter 24/32 - loss 2.33545110 - samples/sec: 53.25 - lr: 0.100000
2021-03-16 13:17:45,877 epoch 6 - iter 27/32 - loss 2.33991373 - samples/sec: 59.87 - lr: 0.100000
2021-03-16 13:17:47,957 epoch 6 - iter 30/32 - loss 2.32352488 - samples/sec: 46.18 - lr: 0.100000
2021-03-16 13:17:48,691 ----------------------------------------------------------------------------------------------------
2021-03-16 13:17:48,692 EPOCH 6 done: loss 2.2970 - lr 0.1000000
2021-03-16 13:17:49,487 DEV : loss 2.6698193550109863 - score 0.9727
2021-03-16 13:17:49,503 BAD EPOCHS (no improvement): 3
2021-03-16 13:17:49,504 ----------------------------------------------------------------------------------------------------
2021-03-16 13:17:51,442 epoch 7 - iter 3/32 - loss 1.77444025 - samples/sec: 49.59 - lr: 0.100000
2021-03-16 13:17:54,037 epoch 7 - iter 6/32 - loss 1.90067114 - samples/sec: 37.00 - lr: 0.100000
2021-03-16 13:17:55,820 epoch 7 - iter 9/32 - loss 2.09291303 - samples/sec: 53.88 - lr: 0.100000
2021-03-16 13:17:57,578 epoch 7 - iter 12/32 - loss 2.18245301 - samples/sec: 54.64 - lr: 0.100000
2021-03-16 13:17:59,569 epoch 7 - iter 15/32 - loss 2.21381622 - samples/sec: 48.23 - lr: 0.100000
2021-03-16 13:18:01,475 epoch 7 - iter 18/32 - loss 2.18776820 - samples/sec: 50.39 - lr: 0.100000
2021-03-16 13:18:03,422 epoch 7 - iter 21/32 - loss 2.20856661 - samples/sec: 49.33 - lr: 0.100000
2021-03-16 13:18:05,609 epoch 7 - iter 24/32 - loss 2.25082518 - samples/sec: 43.92 - lr: 0.100000
2021-03-16 13:18:07,571 epoch 7 - iter 27/32 - loss 2.23469789 - samples/sec: 48.97 - lr: 0.100000
2021-03-16 13:18:09,297 epoch 7 - iter 30/32 - loss 2.24407813 - samples/sec: 55.67 - lr: 0.100000
2021-03-16 13:18:10,148 ----------------------------------------------------------------------------------------------------
2021-03-16 13:18:10,149 EPOCH 7 done: loss 2.1745 - lr 0.1000000
2021-03-16 13:18:10,938 DEV : loss 2.7815513610839844 - score 0.9727
2021-03-16 13:18:10,954 BAD EPOCHS (no improvement): 4
2021-03-16 13:18:10,956 ----------------------------------------------------------------------------------------------------
2021-03-16 13:18:12,814 epoch 8 - iter 3/32 - loss 2.35775582 - samples/sec: 51.69 - lr: 0.050000
2021-03-16 13:18:14,734 epoch 8 - iter 6/32 - loss 2.14522556 - samples/sec: 50.03 - lr: 0.050000
2021-03-16 13:18:16,724 epoch 8 - iter 9/32 - loss 2.22224400 - samples/sec: 48.26 - lr: 0.050000
2021-03-16 13:18:18,617 epoch 8 - iter 12/32 - loss 2.15922425 - samples/sec: 50.77 - lr: 0.050000
2021-03-16 13:18:20,475 epoch 8 - iter 15/32 - loss 2.27717735 - samples/sec: 51.68 - lr: 0.050000
2021-03-16 13:18:22,406 epoch 8 - iter 18/32 - loss 2.24282189 - samples/sec: 49.75 - lr: 0.050000
2021-03-16 13:18:24,006 epoch 8 - iter 21/32 - loss 2.20743694 - samples/sec: 60.03 - lr: 0.050000
2021-03-16 13:18:25,903 epoch 8 - iter 24/32 - loss 2.17742990 - samples/sec: 50.64 - lr: 0.050000
2021-03-16 13:18:27,941 epoch 8 - iter 27/32 - loss 2.10845494 - samples/sec: 47.13 - lr: 0.050000
2021-03-16 13:18:30,585 epoch 8 - iter 30/32 - loss 2.10400785 - samples/sec: 36.33 - lr: 0.050000
2021-03-16 13:18:31,468 ----------------------------------------------------------------------------------------------------
2021-03-16 13:18:31,469 EPOCH 8 done: loss 2.1719 - lr 0.0500000
2021-03-16 13:18:32,261 DEV : loss 2.334167718887329 - score 0.9741
2021-03-16 13:18:32,278 BAD EPOCHS (no improvement): 0
2021-03-16 13:18:37,975 ----------------------------------------------------------------------------------------------------
2021-03-16 13:18:37,975 Testing using best model ...
2021-03-16 13:18:37,977 loading file resources/taggers/motion_class/best-model.pt
2021-03-16 13:19:09,500 	0.977
2021-03-16 13:19:09,501 
Results:
- F-score (micro): 0.977
- F-score (macro): 0.188
- Accuracy (incl. no class): 0.977

By class:
               precision    recall  f1-score   support

            O     0.9855    0.9979    0.9917      7025
        CROSS     1.0000    0.0000    0.0000        16
        REACH     0.5574    0.4658    0.5075        73
MOVE_EXTERNAL     1.0000    0.0000    0.0000         7
       FOLLOW     0.0000    0.0000    0.0000        16
         MOVE     0.3061    0.3333    0.3191        45
          HIT     1.0000    0.0000    0.0000        13
        LEAVE     1.0000    0.1429    0.2500        14
      DEVIATE     1.0000    0.0000    0.0000         4
MOVE_INTERNAL     1.0000    0.0000    0.0000        11
       DETACH     1.0000    0.0000    0.0000         3

     accuracy                         0.9770      7227
    macro avg     0.8045    0.1763    0.1880      7227
 weighted avg     0.9749    0.9770    0.9715      7227

2021-03-16 13:19:09,502 ----------------------------------------------------------------------------------------------------
