2021-03-16 13:24:36,898 ----------------------------------------------------------------------------------------------------
2021-03-16 13:24:36,899 Model: "SequenceTagger(
  (embeddings): StackedEmbeddings(
    (list_embedding_0): WordEmbeddings('glove')
    (list_embedding_1): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
    (list_embedding_2): FlairEmbeddings(
      (lm): LanguageModel(
        (drop): Dropout(p=0.25, inplace=False)
        (encoder): Embedding(275, 100)
        (rnn): LSTM(100, 1024)
        (decoder): Linear(in_features=1024, out_features=275, bias=True)
      )
    )
  )
  (word_dropout): WordDropout(p=0.05)
  (locked_dropout): LockedDropout(p=0.5)
  (embedding2nn): Linear(in_features=2148, out_features=2148, bias=True)
  (rnn): LSTM(2148, 128, batch_first=True, bidirectional=True)
  (linear): Linear(in_features=256, out_features=7, bias=True)
  (beta): 1.0
  (weights): None
  (weight_tensor) None
)"
2021-03-16 13:24:36,900 ----------------------------------------------------------------------------------------------------
2021-03-16 13:24:36,900 Corpus: "Corpus: 1000 train + 111 dev + 289 test sentences"
2021-03-16 13:24:36,902 ----------------------------------------------------------------------------------------------------
2021-03-16 13:24:36,902 Parameters:
2021-03-16 13:24:36,903  - learning_rate: "0.1"
2021-03-16 13:24:36,904  - mini_batch_size: "32"
2021-03-16 13:24:36,904  - patience: "3"
2021-03-16 13:24:36,905  - anneal_factor: "0.5"
2021-03-16 13:24:36,906  - max_epochs: "8"
2021-03-16 13:24:36,907  - shuffle: "True"
2021-03-16 13:24:36,907  - train_with_dev: "False"
2021-03-16 13:24:36,908  - batch_growth_annealing: "False"
2021-03-16 13:24:36,909 ----------------------------------------------------------------------------------------------------
2021-03-16 13:24:36,909 Model training base path: "resources/taggers/semantic_type"
2021-03-16 13:24:36,910 ----------------------------------------------------------------------------------------------------
2021-03-16 13:24:36,921 Device: cpu
2021-03-16 13:24:36,922 ----------------------------------------------------------------------------------------------------
2021-03-16 13:24:36,922 Embeddings storage mode: cpu
2021-03-16 13:24:36,925 ----------------------------------------------------------------------------------------------------
2021-03-16 13:24:46,671 epoch 1 - iter 3/32 - loss 20.28822200 - samples/sec: 9.85 - lr: 0.100000
2021-03-16 13:24:58,471 epoch 1 - iter 6/32 - loss 12.96539744 - samples/sec: 8.14 - lr: 0.100000
2021-03-16 13:25:08,326 epoch 1 - iter 9/32 - loss 10.14079958 - samples/sec: 9.74 - lr: 0.100000
2021-03-16 13:25:19,877 epoch 1 - iter 12/32 - loss 8.63200088 - samples/sec: 8.31 - lr: 0.100000
2021-03-16 13:25:30,747 epoch 1 - iter 15/32 - loss 7.71850958 - samples/sec: 8.83 - lr: 0.100000
2021-03-16 13:25:41,812 epoch 1 - iter 18/32 - loss 6.94456544 - samples/sec: 8.68 - lr: 0.100000
2021-03-16 13:25:58,665 epoch 1 - iter 21/32 - loss 6.38464523 - samples/sec: 5.70 - lr: 0.100000
2021-03-16 13:26:08,620 epoch 1 - iter 24/32 - loss 5.96376289 - samples/sec: 9.64 - lr: 0.100000
2021-03-16 13:26:18,430 epoch 1 - iter 27/32 - loss 5.67756573 - samples/sec: 9.79 - lr: 0.100000
2021-03-16 13:26:30,178 epoch 1 - iter 30/32 - loss 5.44918476 - samples/sec: 8.17 - lr: 0.100000
2021-03-16 13:26:34,966 ----------------------------------------------------------------------------------------------------
2021-03-16 13:26:34,967 EPOCH 1 done: loss 5.2525 - lr 0.1000000
2021-03-16 13:26:45,786 DEV : loss 2.968222141265869 - score 0.9679
2021-03-16 13:26:45,804 BAD EPOCHS (no improvement): 0
2021-03-16 13:26:48,480 ----------------------------------------------------------------------------------------------------
2021-03-16 13:26:50,327 epoch 2 - iter 3/32 - loss 2.96744100 - samples/sec: 52.02 - lr: 0.100000
2021-03-16 13:26:52,148 epoch 2 - iter 6/32 - loss 2.94151704 - samples/sec: 52.76 - lr: 0.100000
2021-03-16 13:26:54,457 epoch 2 - iter 9/32 - loss 2.80840561 - samples/sec: 41.60 - lr: 0.100000
2021-03-16 13:26:56,178 epoch 2 - iter 12/32 - loss 2.65685508 - samples/sec: 55.79 - lr: 0.100000
2021-03-16 13:26:59,115 epoch 2 - iter 15/32 - loss 2.84663282 - samples/sec: 32.71 - lr: 0.100000
2021-03-16 13:27:01,002 epoch 2 - iter 18/32 - loss 2.85681595 - samples/sec: 50.91 - lr: 0.100000
2021-03-16 13:27:02,846 epoch 2 - iter 21/32 - loss 2.84469460 - samples/sec: 52.07 - lr: 0.100000
2021-03-16 13:27:04,675 epoch 2 - iter 24/32 - loss 2.81093487 - samples/sec: 52.51 - lr: 0.100000
2021-03-16 13:27:06,236 epoch 2 - iter 27/32 - loss 2.78389706 - samples/sec: 61.54 - lr: 0.100000
2021-03-16 13:27:07,952 epoch 2 - iter 30/32 - loss 2.78643099 - samples/sec: 55.98 - lr: 0.100000
2021-03-16 13:27:08,774 ----------------------------------------------------------------------------------------------------
2021-03-16 13:27:08,775 EPOCH 2 done: loss 2.6999 - lr 0.1000000
2021-03-16 13:27:09,548 DEV : loss 2.1599936485290527 - score 0.9753
2021-03-16 13:27:09,563 BAD EPOCHS (no improvement): 0
2021-03-16 13:27:12,724 ----------------------------------------------------------------------------------------------------
2021-03-16 13:27:14,476 epoch 3 - iter 3/32 - loss 2.52877609 - samples/sec: 54.85 - lr: 0.100000
2021-03-16 13:27:16,254 epoch 3 - iter 6/32 - loss 2.72402239 - samples/sec: 54.03 - lr: 0.100000
2021-03-16 13:27:18,038 epoch 3 - iter 9/32 - loss 2.61169668 - samples/sec: 53.86 - lr: 0.100000
2021-03-16 13:27:19,756 epoch 3 - iter 12/32 - loss 2.41872810 - samples/sec: 55.90 - lr: 0.100000
2021-03-16 13:27:22,218 epoch 3 - iter 15/32 - loss 2.39318902 - samples/sec: 39.02 - lr: 0.100000
2021-03-16 13:27:24,038 epoch 3 - iter 18/32 - loss 2.39191174 - samples/sec: 52.76 - lr: 0.100000
2021-03-16 13:27:25,735 epoch 3 - iter 21/32 - loss 2.40227669 - samples/sec: 56.61 - lr: 0.100000
2021-03-16 13:27:27,584 epoch 3 - iter 24/32 - loss 2.44198885 - samples/sec: 51.95 - lr: 0.100000
2021-03-16 13:27:29,775 epoch 3 - iter 27/32 - loss 2.39597039 - samples/sec: 43.84 - lr: 0.100000
2021-03-16 13:27:31,938 epoch 3 - iter 30/32 - loss 2.40597995 - samples/sec: 44.40 - lr: 0.100000
2021-03-16 13:27:32,770 ----------------------------------------------------------------------------------------------------
2021-03-16 13:27:32,771 EPOCH 3 done: loss 2.4752 - lr 0.1000000
2021-03-16 13:27:33,535 DEV : loss 2.160522222518921 - score 0.9711
2021-03-16 13:27:33,550 BAD EPOCHS (no improvement): 1
2021-03-16 13:27:33,551 ----------------------------------------------------------------------------------------------------
2021-03-16 13:27:36,598 epoch 4 - iter 3/32 - loss 3.33860946 - samples/sec: 31.52 - lr: 0.100000
2021-03-16 13:27:38,182 epoch 4 - iter 6/32 - loss 2.82515810 - samples/sec: 60.66 - lr: 0.100000
2021-03-16 13:27:39,910 epoch 4 - iter 9/32 - loss 2.55333057 - samples/sec: 55.59 - lr: 0.100000
2021-03-16 13:27:41,604 epoch 4 - iter 12/32 - loss 2.46783942 - samples/sec: 56.68 - lr: 0.100000
2021-03-16 13:27:43,682 epoch 4 - iter 15/32 - loss 2.42958188 - samples/sec: 46.22 - lr: 0.100000
2021-03-16 13:27:45,544 epoch 4 - iter 18/32 - loss 2.34456905 - samples/sec: 51.60 - lr: 0.100000
2021-03-16 13:27:47,373 epoch 4 - iter 21/32 - loss 2.25549151 - samples/sec: 52.51 - lr: 0.100000
2021-03-16 13:27:49,514 epoch 4 - iter 24/32 - loss 2.21167952 - samples/sec: 44.86 - lr: 0.100000
2021-03-16 13:27:51,165 epoch 4 - iter 27/32 - loss 2.19955199 - samples/sec: 58.19 - lr: 0.100000
2021-03-16 13:27:53,387 epoch 4 - iter 30/32 - loss 2.17758318 - samples/sec: 43.22 - lr: 0.100000
2021-03-16 13:27:54,326 ----------------------------------------------------------------------------------------------------
2021-03-16 13:27:54,327 EPOCH 4 done: loss 2.1518 - lr 0.1000000
2021-03-16 13:27:55,094 DEV : loss 1.888390302658081 - score 0.9711
2021-03-16 13:27:55,109 BAD EPOCHS (no improvement): 2
2021-03-16 13:27:55,111 ----------------------------------------------------------------------------------------------------
2021-03-16 13:27:56,719 epoch 5 - iter 3/32 - loss 2.15392240 - samples/sec: 59.74 - lr: 0.100000
2021-03-16 13:27:58,545 epoch 5 - iter 6/32 - loss 2.30312085 - samples/sec: 52.60 - lr: 0.100000
2021-03-16 13:28:00,484 epoch 5 - iter 9/32 - loss 2.11772923 - samples/sec: 49.55 - lr: 0.100000
2021-03-16 13:28:02,452 epoch 5 - iter 12/32 - loss 2.09061449 - samples/sec: 48.80 - lr: 0.100000
2021-03-16 13:28:04,752 epoch 5 - iter 15/32 - loss 2.18214056 - samples/sec: 41.75 - lr: 0.100000
2021-03-16 13:28:06,216 epoch 5 - iter 18/32 - loss 2.12796348 - samples/sec: 65.65 - lr: 0.100000
2021-03-16 13:28:08,062 epoch 5 - iter 21/32 - loss 2.10383906 - samples/sec: 52.03 - lr: 0.100000
2021-03-16 13:28:09,804 epoch 5 - iter 24/32 - loss 2.06099779 - samples/sec: 55.14 - lr: 0.100000
2021-03-16 13:28:11,519 epoch 5 - iter 27/32 - loss 2.06608687 - samples/sec: 55.99 - lr: 0.100000
2021-03-16 13:28:13,674 epoch 5 - iter 30/32 - loss 2.02721563 - samples/sec: 44.58 - lr: 0.100000
2021-03-16 13:28:14,616 ----------------------------------------------------------------------------------------------------
2021-03-16 13:28:14,617 EPOCH 5 done: loss 2.0585 - lr 0.1000000
2021-03-16 13:28:15,384 DEV : loss 1.6468074321746826 - score 0.9743
2021-03-16 13:28:15,399 BAD EPOCHS (no improvement): 3
2021-03-16 13:28:15,401 ----------------------------------------------------------------------------------------------------
2021-03-16 13:28:17,476 epoch 6 - iter 3/32 - loss 1.85379787 - samples/sec: 46.28 - lr: 0.100000
2021-03-16 13:28:19,222 epoch 6 - iter 6/32 - loss 1.75138172 - samples/sec: 55.01 - lr: 0.100000
2021-03-16 13:28:20,791 epoch 6 - iter 9/32 - loss 1.96585963 - samples/sec: 61.23 - lr: 0.100000
2021-03-16 13:28:22,634 epoch 6 - iter 12/32 - loss 1.92309184 - samples/sec: 52.12 - lr: 0.100000
2021-03-16 13:28:24,416 epoch 6 - iter 15/32 - loss 1.90053185 - samples/sec: 53.91 - lr: 0.100000
2021-03-16 13:28:26,303 epoch 6 - iter 18/32 - loss 1.87035683 - samples/sec: 50.91 - lr: 0.100000
2021-03-16 13:28:28,820 epoch 6 - iter 21/32 - loss 1.89013188 - samples/sec: 38.16 - lr: 0.100000
2021-03-16 13:28:30,373 epoch 6 - iter 24/32 - loss 1.93240914 - samples/sec: 61.84 - lr: 0.100000
2021-03-16 13:28:32,436 epoch 6 - iter 27/32 - loss 1.94535037 - samples/sec: 46.55 - lr: 0.100000
2021-03-16 13:28:34,224 epoch 6 - iter 30/32 - loss 1.99262120 - samples/sec: 53.72 - lr: 0.100000
2021-03-16 13:28:35,060 ----------------------------------------------------------------------------------------------------
2021-03-16 13:28:35,061 EPOCH 6 done: loss 1.9678 - lr 0.1000000
2021-03-16 13:28:35,834 DEV : loss 1.6201701164245605 - score 0.9771
2021-03-16 13:28:35,849 BAD EPOCHS (no improvement): 0
2021-03-16 13:28:39,003 ----------------------------------------------------------------------------------------------------
2021-03-16 13:28:40,713 epoch 7 - iter 3/32 - loss 1.89972051 - samples/sec: 56.19 - lr: 0.100000
2021-03-16 13:28:42,546 epoch 7 - iter 6/32 - loss 1.77602140 - samples/sec: 52.40 - lr: 0.100000
2021-03-16 13:28:45,151 epoch 7 - iter 9/32 - loss 1.92278771 - samples/sec: 36.87 - lr: 0.100000
2021-03-16 13:28:47,322 epoch 7 - iter 12/32 - loss 2.03894400 - samples/sec: 44.24 - lr: 0.100000
2021-03-16 13:28:48,971 epoch 7 - iter 15/32 - loss 1.91005299 - samples/sec: 58.24 - lr: 0.100000
2021-03-16 13:28:51,271 epoch 7 - iter 18/32 - loss 1.89888026 - samples/sec: 41.75 - lr: 0.100000
2021-03-16 13:28:52,941 epoch 7 - iter 21/32 - loss 1.93092015 - samples/sec: 57.53 - lr: 0.100000
2021-03-16 13:28:54,707 epoch 7 - iter 24/32 - loss 1.92681095 - samples/sec: 54.39 - lr: 0.100000
2021-03-16 13:28:56,560 epoch 7 - iter 27/32 - loss 1.95354623 - samples/sec: 51.85 - lr: 0.100000
2021-03-16 13:28:58,207 epoch 7 - iter 30/32 - loss 1.89938762 - samples/sec: 58.32 - lr: 0.100000
2021-03-16 13:28:59,121 ----------------------------------------------------------------------------------------------------
2021-03-16 13:28:59,122 EPOCH 7 done: loss 1.8869 - lr 0.1000000
2021-03-16 13:29:00,192 DEV : loss 1.6858304738998413 - score 0.9768
2021-03-16 13:29:00,209 BAD EPOCHS (no improvement): 1
2021-03-16 13:29:00,210 ----------------------------------------------------------------------------------------------------
2021-03-16 13:29:02,146 epoch 8 - iter 3/32 - loss 2.13893489 - samples/sec: 49.65 - lr: 0.100000
2021-03-16 13:29:04,307 epoch 8 - iter 6/32 - loss 2.00233030 - samples/sec: 44.44 - lr: 0.100000
2021-03-16 13:29:06,671 epoch 8 - iter 9/32 - loss 1.98221160 - samples/sec: 40.63 - lr: 0.100000
2021-03-16 13:29:08,418 epoch 8 - iter 12/32 - loss 1.89125788 - samples/sec: 54.98 - lr: 0.100000
2021-03-16 13:29:10,107 epoch 8 - iter 15/32 - loss 1.82502854 - samples/sec: 56.87 - lr: 0.100000
2021-03-16 13:29:12,207 epoch 8 - iter 18/32 - loss 1.80770348 - samples/sec: 45.73 - lr: 0.100000
2021-03-16 13:29:14,016 epoch 8 - iter 21/32 - loss 1.83134721 - samples/sec: 53.09 - lr: 0.100000
2021-03-16 13:29:16,049 epoch 8 - iter 24/32 - loss 1.93225364 - samples/sec: 47.24 - lr: 0.100000
2021-03-16 13:29:17,841 epoch 8 - iter 27/32 - loss 1.84808857 - samples/sec: 53.61 - lr: 0.100000
2021-03-16 13:29:19,545 epoch 8 - iter 30/32 - loss 1.82972978 - samples/sec: 56.38 - lr: 0.100000
2021-03-16 13:29:20,268 ----------------------------------------------------------------------------------------------------
2021-03-16 13:29:20,269 EPOCH 8 done: loss 1.8130 - lr 0.1000000
2021-03-16 13:29:21,033 DEV : loss 1.4880489110946655 - score 0.9785
2021-03-16 13:29:21,048 BAD EPOCHS (no improvement): 0
2021-03-16 13:29:26,904 ----------------------------------------------------------------------------------------------------
2021-03-16 13:29:26,906 Testing using best model ...
2021-03-16 13:29:26,907 loading file resources/taggers/semantic_type/best-model.pt
2021-03-16 13:29:58,565 	0.9799
2021-03-16 13:29:58,565 
Results:
- F-score (micro): 0.9799
- F-score (macro): 0.4072
- Accuracy (incl. no class): 0.9799

By class:
              precision    recall  f1-score   support

           O     0.9856    0.9940    0.9898      7039
 TOPOLOGICAL     0.6641    0.6159    0.6391       138
     DIR_TOP     1.0000    0.0000    0.0000        28
 DIRECTIONAL     1.0000    0.0000    0.0000        22

    accuracy                         0.9799      7227
   macro avg     0.9124    0.4025    0.4072      7227
weighted avg     0.9796    0.9799    0.9763      7227

2021-03-16 13:29:58,566 ----------------------------------------------------------------------------------------------------
